{"ast":null,"code":"var _jsxFileName = \"/home/frangb/Documentos/xolos/practicas/src/components/Admin/Permisos/PermisosAsignados.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React from 'react';\nimport { useEffect, useState } from 'react';\nimport { IoIosSave } from 'react-icons/io';\nimport { GiMagnifyingGlass } from 'react-icons/gi';\nimport Check from '../../Template/Check';\nimport Buscador from '../../Template/Buscador';\nimport { guardarRolPermisos } from '../../../api/adminApi';\nimport Boton from '../../Template/Boton';\nimport i18next from 'i18next';\nimport { can } from '../../../services/seguridadService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst buscadores = [{\n  alias: 'id',\n  posicion: 'id',\n  placeholder: 'Buscador',\n  mostrar: 'hidden'\n}, {\n  alias: 'nombre',\n  posicion: 'nombre',\n  placeholder: 'Buscador'\n}, {\n  alias: 'descripcion',\n  posicion: 'descripcion',\n  placeholder: 'Buscador'\n}];\n\nconst PermisosAsignados = ({\n  seccionesAsig,\n  setSeccionesAsig,\n  rolSelect\n}) => {\n  _s();\n\n  let secciones = [...seccionesAsig];\n\n  const guardarDatos = secciones => {\n    //validacion de datos\n    let rol = rolSelect;\n    rol.rels_rol_permiso = [];\n    (secciones || []).map(seccion => {\n      (seccion.permisos || []).map((permiso, idxpermiso) => {\n        if (permiso.aplica) rol.rels_rol_permiso.push({\n          permiso: permiso,\n          permiso_id: permiso.id\n        });\n      });\n    });\n    guardarRolPermisos(rol).then(response => {});\n  }; //----------------useEffects-------------------//\n\n\n  useEffect(() => {\n    let seccionesLocal = [...seccionesAsig];\n    (seccionesLocal || []).map(seccion => {\n      (seccion.permisos || []).map(permiso => {\n        permiso.aplica = false;\n        rolSelect.rels_rol_permiso.map(rol => {\n          if (rol.permiso_id === permiso.id) {\n            permiso.aplica = true;\n          }\n        });\n      });\n      seccion.aplica = true;\n      (seccion.permisos || []).map(permiso => seccion.aplica = seccion.aplica && permiso.aplica);\n    });\n    setSeccionesAsig(seccionesLocal);\n  }, [rolSelect]); //--------------./useEffects-------------------//\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card d-flex mx-4 border-tabla z-depth-2 animated bounceInUp\",\n    children: [/*#__PURE__*/_jsxDEV(Encabezado, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Contenido, {\n      secciones: secciones,\n      setSeccionesAsig: setSeccionesAsig,\n      guardarDatos: guardarDatos,\n      buscadores: buscadores\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 9\n  }, this);\n};\n\n_s(PermisosAsignados, \"OD7bBpZva5O2jO+Puf00hKivP7c=\");\n\n_c = PermisosAsignados;\n\nconst Encabezado = () => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card-header d-flex justify-content-center text-center py-0\",\n    children: /*#__PURE__*/_jsxDEV(\"h5\", {\n      className: \"text-center text-titulo-tabla txts_gray pt-2\",\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"py-2 px-2\",\n        children: i18next.t('admin:permisosAsig')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 9\n  }, this);\n};\n\n_c2 = Encabezado;\n\nconst Contenido = ({\n  secciones,\n  setSeccionesAsig,\n  guardarDatos,\n  buscadores\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card-body p-0\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"div_tabla\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"my-2 mx-3\",\n          children: /*#__PURE__*/_jsxDEV(Boton, {\n            key_texto: i18next.t(\"general:guardar\"),\n            className: \"btn-outline-success w-100\",\n            habilitado: can('admin.guardar_permisos_asignados'),\n            ejecuta: () => guardarDatos(secciones),\n            children: /*#__PURE__*/_jsxDEV(IoIosSave, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mx-3\",\n          children: (secciones || []).map((seccion, seccionIdx) => /*#__PURE__*/_jsxDEV(Renglon, {\n            seccionIdx: seccionIdx,\n            seccion: seccion,\n            setSeccionesAsig: setSeccionesAsig,\n            secciones: secciones,\n            buscadores: buscadores\n          }, seccionIdx, false, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 29\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 9\n  }, this);\n};\n\n_c3 = Contenido;\n\nconst Renglon = ({\n  seccionIdx,\n  seccion,\n  setSeccionesAsig,\n  secciones,\n  buscadores\n}) => {\n  _s2();\n\n  //variables locales\n  const [permisosFiltro, setPermisosFiltro] = useState([]);\n  const [mostrar, setMostrar] = useState(false);\n\n  const iguales = valores => valores.aplica === true;\n\n  const actualizaPermiso = (seccionIdx, indicePermiso, permiso) => {\n    secciones[seccionIdx].permisos.map(per => {\n      if (per.id === permiso.id) {\n        per.aplica = !per.aplica;\n      }\n    });\n    secciones[seccionIdx].permisos.every(iguales) ? secciones[seccionIdx].aplica = true : secciones[seccionIdx].aplica = false;\n\n    if (permisosFiltro > 0) {\n      permisosFiltro[indicePermiso].aplica = !permisosFiltro[indicePermiso].aplica;\n      setPermisosFiltro(permisosFiltro);\n    }\n\n    setSeccionesAsig(secciones);\n  };\n\n  const actualizaSeccion = seccionIdx => {\n    if (secciones[seccionIdx].aplica === true) {\n      secciones[seccionIdx].aplica = false;\n      secciones[seccionIdx].permisos.map(permiso => {\n        permiso.aplica = false;\n      });\n      setSeccionesAsig(secciones);\n    } else {\n      secciones[seccionIdx].aplica = true;\n      secciones[seccionIdx].permisos.map(permiso => {\n        permiso.aplica = true;\n      });\n      setSeccionesAsig(secciones);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"responsive\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-start\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mr-2\",\n        children: /*#__PURE__*/_jsxDEV(Check, {\n          ejecuta: () => {\n            actualizaSeccion(seccionIdx);\n          },\n          seleccionado: seccion.aplica\n        }, seccion.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mr-1\",\n        children: seccion.nombre\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cursor text-info txts_gray\",\n        onClick: () => {\n          mostrar ? setMostrar(false) : setMostrar(true);\n        },\n        children: /*#__PURE__*/_jsxDEV(GiMagnifyingGlass, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"responsive\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table ml-3 table-condensed table-borderless\",\n        children: [mostrar && /*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"mx-0\",\n          children: /*#__PURE__*/_jsxDEV(Buscador, {\n            setFiltrado: setPermisosFiltro,\n            arr_sin_filtrar: seccion.permisos,\n            buscadores: buscadores,\n            estado_inicial: null\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          className: \"\",\n          children: ((permisosFiltro.length === 0 ? seccion.permisos : permisosFiltro) || []).map((permiso, indicePermiso) => /*#__PURE__*/_jsxDEV(\"tr\", {\n            className: \"\",\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mr-2\",\n                children: /*#__PURE__*/_jsxDEV(Check, {\n                  ejecuta: () => actualizaPermiso(seccionIdx, indicePermiso, permiso),\n                  seleccionado: permiso.aplica\n                }, permiso.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mr-5\",\n                children: permiso.nombre\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"\",\n              children: permiso.descripcion\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 29\n            }, this)]\n          }, indicePermiso, true, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 25\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(Renglon, \"P2oCcLjYxz0nTEoZW8vZo5+e54I=\");\n\n_c4 = Renglon;\nexport default PermisosAsignados;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"PermisosAsignados\");\n$RefreshReg$(_c2, \"Encabezado\");\n$RefreshReg$(_c3, \"Contenido\");\n$RefreshReg$(_c4, \"Renglon\");","map":{"version":3,"sources":["/home/frangb/Documentos/xolos/practicas/src/components/Admin/Permisos/PermisosAsignados.js"],"names":["React","useEffect","useState","IoIosSave","GiMagnifyingGlass","Check","Buscador","guardarRolPermisos","Boton","i18next","can","buscadores","alias","posicion","placeholder","mostrar","PermisosAsignados","seccionesAsig","setSeccionesAsig","rolSelect","secciones","guardarDatos","rol","rels_rol_permiso","map","seccion","permisos","permiso","idxpermiso","aplica","push","permiso_id","id","then","response","seccionesLocal","Encabezado","t","Contenido","seccionIdx","Renglon","permisosFiltro","setPermisosFiltro","setMostrar","iguales","valores","actualizaPermiso","indicePermiso","per","every","actualizaSeccion","nombre","length","descripcion"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useEffect, useState } from 'react';\nimport { IoIosSave } from 'react-icons/io';\nimport { GiMagnifyingGlass } from 'react-icons/gi';\nimport Check from '../../Template/Check';\nimport Buscador from '../../Template/Buscador';\nimport { guardarRolPermisos } from '../../../api/adminApi';\nimport Boton from '../../Template/Boton';\nimport i18next from 'i18next';\nimport {can} from '../../../services/seguridadService'\n\nconst buscadores = [\n    { alias: 'id', posicion: 'id', placeholder: 'Buscador', mostrar: 'hidden' },\n    { alias: 'nombre', posicion: 'nombre', placeholder: 'Buscador' },\n    { alias: 'descripcion', posicion: 'descripcion', placeholder: 'Buscador' }\n];\n\nconst PermisosAsignados = ({ seccionesAsig, setSeccionesAsig, rolSelect }) => {\n    let secciones = [...seccionesAsig];\n    const guardarDatos = (secciones) => {\n        //validacion de datos\n        let rol = rolSelect;\n        rol.rels_rol_permiso = [];\n        (secciones || []).map((seccion) => {\n            (seccion.permisos || []).map((permiso, idxpermiso) => {\n                if (permiso.aplica)\n                    rol.rels_rol_permiso.push({ permiso: permiso, permiso_id: permiso.id });\n            });\n        });\n        guardarRolPermisos(rol).then(response => {\n        });\n    };\n\n    //----------------useEffects-------------------//\n    useEffect(() => {\n        let seccionesLocal = [...seccionesAsig];\n        (seccionesLocal || []).map((seccion) => {\n            (seccion.permisos || []).map((permiso) => {\n                permiso.aplica = false;\n                rolSelect.rels_rol_permiso.map((rol) => {\n                    if (rol.permiso_id === permiso.id) {\n                        permiso.aplica = true;\n                    }\n                })\n            });\n            seccion.aplica = true;\n            (seccion.permisos || []).map(permiso => seccion.aplica = seccion.aplica && permiso.aplica);\n        });\n        setSeccionesAsig(seccionesLocal);\n    }, [rolSelect]);\n    //--------------./useEffects-------------------//\n    return (\n        <div className=\"card d-flex mx-4 border-tabla z-depth-2 animated bounceInUp\">\n            <Encabezado />\n            <Contenido\n                secciones={secciones}\n                setSeccionesAsig={setSeccionesAsig}\n                guardarDatos={guardarDatos}\n                buscadores={buscadores}\n            />\n        </div>\n    );\n}\n\nconst Encabezado = () => {\n    return (\n        <div className=\"card-header d-flex justify-content-center text-center py-0\">\n            <h5 className=\"text-center text-titulo-tabla txts_gray pt-2\">\n                <i className=\"py-2 px-2\">{i18next.t('admin:permisosAsig')}</i>\n            </h5>\n        </div>\n    );\n};\n\nconst Contenido = ({ secciones, setSeccionesAsig, guardarDatos, buscadores }) => {\n    return (\n        <div className=\"card-body p-0\">\n            <div id=\"div_tabla\">\n                <div>\n                    <div className=\"my-2 mx-3\">\n                        <Boton key_texto={i18next.t(\"general:guardar\")}\n                               className=\"btn-outline-success w-100\"\n                               habilitado={can('admin.guardar_permisos_asignados')}\n                               ejecuta={() => guardarDatos(secciones)}>\n                            <IoIosSave />\n                        </Boton>\n                    </div>\n                    <div className=\"mx-3\">\n                        {(secciones || []).map((seccion, seccionIdx) =>\n                            <Renglon key={seccionIdx}\n                                     seccionIdx={seccionIdx}\n                                     seccion={seccion}\n                                     setSeccionesAsig={setSeccionesAsig}\n                                     secciones={secciones}\n                                     buscadores={buscadores} />\n                        )}\n\n                    </div>\n\n                </div>\n            </div>\n        </div>\n    );\n}\n\nconst Renglon = ({ seccionIdx, seccion, setSeccionesAsig, secciones, buscadores }) => {\n    //variables locales\n    const [permisosFiltro, setPermisosFiltro] = useState([]);\n    const [mostrar, setMostrar] = useState(false);\n    const iguales = (valores) => valores.aplica === true;\n    const actualizaPermiso = (seccionIdx, indicePermiso, permiso) => {\n        secciones[seccionIdx].permisos.map((per) => {\n            if (per.id === permiso.id) {\n                per.aplica = !per.aplica;\n            }\n        });\n        secciones[seccionIdx].permisos.every(iguales) ? secciones[seccionIdx].aplica = true : secciones[seccionIdx].aplica = false;\n        if (permisosFiltro > 0) {\n            permisosFiltro[indicePermiso].aplica = !permisosFiltro[indicePermiso].aplica;\n            setPermisosFiltro(permisosFiltro);\n        }\n        setSeccionesAsig(secciones);\n    }\n    const actualizaSeccion = (seccionIdx) => {\n        if (secciones[seccionIdx].aplica === true) {\n            secciones[seccionIdx].aplica = false;\n            secciones[seccionIdx].permisos.map((permiso) => {\n                permiso.aplica = false;\n            });\n            setSeccionesAsig(secciones);\n        } else {\n            secciones[seccionIdx].aplica = true;\n            secciones[seccionIdx].permisos.map((permiso) => {\n                permiso.aplica = true;\n            });\n            setSeccionesAsig(secciones);\n        }\n    }\n    return (\n        <div className=\"responsive\">\n            <div className=\"d-flex justify-content-start\">\n                <div className=\"mr-2\">\n                    <Check key={seccion.id} ejecuta={() => {\n                        actualizaSeccion(seccionIdx)\n                    }}\n                           seleccionado={seccion.aplica} />\n                </div>\n                <div className=\"mr-1\">\n                    {seccion.nombre}\n                </div>\n                <div className=\"cursor text-info txts_gray\"\n                     onClick={() => {\n                         mostrar ? setMostrar(false) : setMostrar(true);\n                     }}>\n                    <GiMagnifyingGlass />\n                </div>\n            </div>\n            <div className=\"responsive\">\n                <table className=\"table ml-3 table-condensed table-borderless\">\n                    {mostrar &&\n                    <thead className=\"mx-0\">\n                    <Buscador setFiltrado={setPermisosFiltro}\n                              arr_sin_filtrar={seccion.permisos}\n                              buscadores={buscadores}\n                              estado_inicial={null} />\n                    </thead>\n                    }\n                    <tbody className=\"\">\n                    {((permisosFiltro.length === 0 ? seccion.permisos : permisosFiltro) || []).map((permiso, indicePermiso) =>\n                        <tr key={indicePermiso} className=\"\">\n                            <td>\n                                <div className=\"mr-2\">\n                                    <Check key={permiso.id}\n                                           ejecuta={() =>actualizaPermiso(seccionIdx, indicePermiso, permiso)}\n                                           seleccionado={permiso.aplica} />\n                                </div>\n                            </td>\n                            <td>\n                                <div className=\"mr-5\">\n                                    {permiso.nombre}\n                                </div>\n                            </td>\n                            <td className=\"\">\n                                {permiso.descripcion}\n                            </td>\n                        </tr>\n                    )}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n}\n\nexport default PermisosAsignados;"]},"metadata":{},"sourceType":"module"}