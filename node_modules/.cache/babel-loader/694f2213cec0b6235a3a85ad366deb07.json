{"ast":null,"code":"var _jsxFileName = \"/home/frangb/Documentos/xolos/practicas/src/components/Admin/EspecificacionEquipo/Analisis.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport i18next from \"i18next\";\nimport Boton from \"../../Template/Boton\";\nimport { FaSave } from \"react-icons/all\";\nimport Select from \"../../Template/Select\";\nimport produce from \"immer\";\nimport Campo from \"../../Template/Campo\";\nimport { FaPlusCircle, FaTrash } from \"react-icons/fa\";\nimport { guardarEspecificaciones } from \"../../../api/adminApi\";\nimport { cerrarAlert, ocultableInfo } from \"../../../services/swalService\";\nimport { noop } from \"../../../services/generalService\";\nimport TooltipHover from \"../../Template/TooltipHover\";\nimport { can } from '../../../services/seguridadService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Analisis = ({\n  equipo,\n  analisis,\n  parametros,\n  cargarRegistros\n}) => {\n  _s();\n\n  //|------hooks------|//\n  const [eqEspecs, setEqEspecs] = useState([]);\n  const [invalido, setInvalido] = useState(false); //|------useEffect------|//\n\n  useEffect(() => {\n    setEqEspecs(equipo);\n  }, [equipo]); //|------Operaciones------|//\n\n  const agregarAnalisis = () => {\n    setEqEspecs(produce(eqEspecs, d => {\n      d.rels_equipo_analisis.push({\n        analisis: {},\n        eq_especs: [],\n        equipo_id: equipo.id\n      });\n    }));\n  };\n\n  const eliminarAnalisis = idx => {\n    setEqEspecs(produce(eqEspecs, d => {\n      d.rels_equipo_analisis.splice(idx, 1);\n    }));\n    setInvalido(false);\n  };\n\n  const agregarEspecificacion = idx => {\n    setEqEspecs(produce(eqEspecs, d => {\n      d.rels_equipo_analisis[idx].eq_especs.push({\n        inicio_minimo: '',\n        inicio_maximo: '',\n        fin_minimo: '',\n        fin_maximo: '',\n        parametro: {}\n      });\n    }));\n  };\n\n  const eliminarEspecificacion = (idx, ind) => {\n    setEqEspecs(produce(eqEspecs, d => {\n      d.rels_equipo_analisis[idx].eq_especs.splice(ind, 1);\n    }));\n    setInvalido(false);\n  }; //|-------Api-------|//\n\n\n  const guardar = () => {\n    console.log(eqEspecs.rels_equipo_analisis);\n    guardarEspecificaciones(eqEspecs).then(res => {\n      cerrarAlert();\n      cargarRegistros();\n    }).catch(noop());\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card d-flex mx-4 border-tabla z-depth-2 animated bounceInUp\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" card-header d-flex justify-content-between text-center py-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Boton, {\n            key_texto: i18next.t('admin:agregarAnalisis'),\n            className: \"btn btn-outline-success\",\n            habilitado: can('admin.agregar_analisis'),\n            ejecuta: () => agregarAnalisis(),\n            children: /*#__PURE__*/_jsxDEV(FaPlusCircle, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Boton, {\n            key_texto: i18next.t('general:guardar'),\n            className: \"btn btn-outline-indigo\",\n            habilitado: can('admin.guardar_especificacion') && invalido === false,\n            ejecuta: () => guardar(),\n            children: /*#__PURE__*/_jsxDEV(FaSave, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: (eqEspecs.rels_equipo_analisis || []).map((eqAna, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-start mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-start\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-nowrap mr-2\",\n                children: [i18next.t('admin:tipoAnalisis'), \":\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Select, {\n                options: analisis,\n                selected: eqAna.analisis,\n                onSelect: e => setEqEspecs(produce(eqEspecs, d => {\n                  let resultado = null;\n\n                  if (e) {\n                    resultado = d.rels_equipo_analisis.find(eq => eq.analisis.id === e.id);\n\n                    if (resultado) {\n                      d.rels_equipo_analisis[idx].analisis = {\n                        id: ''\n                      };\n                      setInvalido(true);\n                      ocultableInfo(i18next.t('general:registroDuplicado'));\n                    } else {\n                      d.rels_equipo_analisis[idx].analisis = e;\n                      setInvalido(false);\n                    }\n                  } else {\n                    d.rels_equipo_analisis[idx].analisis = {\n                      id: ''\n                    };\n                  }\n                })),\n                labelKey: \"nombre\",\n                className: `mr-2 ${eqAna.analisis.id === '' ? 'is-invalid' : ''}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [can('admin.agregar_especificacion') ? /*#__PURE__*/_jsxDEV(Boton, {\n                key_texto: i18next.t('admin:agregarEspecificacion'),\n                className: \"btn btn-outline-success text-nowrap py-1 px-1 mb-1 mr-1\",\n                habilitado: true,\n                classNoHabilitado: \"w-70 p-0 m-0\",\n                ejecuta: () => agregarEspecificacion(idx),\n                children: /*#__PURE__*/_jsxDEV(FaPlusCircle, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 115,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 41\n              }, this) : null, can('admin.eliminar_analisis') ? /*#__PURE__*/_jsxDEV(Boton, {\n                key_texto: i18next.t('admin:eliminarAnalisis'),\n                className: \"btn btn-outline-danger text-nowrap py-1 px-1 mb-1\",\n                classNoHabilitado: \"w-50 p-0 m-0\",\n                habilitado: true,\n                ejecuta: () => eliminarAnalisis(idx),\n                children: /*#__PURE__*/_jsxDEV(FaTrash, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 123,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 41\n              }, this) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-start flex-wrap\",\n            children: (eqAna.eq_especs || []).map((esp, ind) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"jumbotron mr-1 py-1 pt-1 px-2\",\n              children: [can('admin.eliminar_especificacion') ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-end mb-1\",\n                children: /*#__PURE__*/_jsxDEV(TooltipHover, {\n                  posicion: \"bottom\",\n                  texto: i18next.t('general:eliminar'),\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    className: \"close\",\n                    \"data-dismiss\": \"alert\",\n                    \"aria-label\": \"Close\",\n                    onClick: () => eliminarEspecificacion(idx, ind),\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      \"aria-hidden\": \"true\",\n                      children: \"\\xD7\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 136,\n                      columnNumber: 57\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 133,\n                    columnNumber: 53\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 49\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 131,\n                columnNumber: 45\n              }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-start\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-nowrap mr-2\",\n                  children: [i18next.t('admin:tipoParametro'), \":\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 141,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(Select, {\n                  options: parametros,\n                  selected: esp.parametro || {\n                    id: ''\n                  },\n                  onSelect: e => setEqEspecs(produce(eqEspecs, d => {\n                    let resultado = null;\n\n                    if (e) {\n                      resultado = d.rels_equipo_analisis[idx].eq_especs.find(eq => eq.parametro.id === e.id);\n\n                      if (resultado) {\n                        d.rels_equipo_analisis[idx].eq_especs[ind].parametro = {\n                          id: ''\n                        };\n                        setInvalido(true);\n                        ocultableInfo(i18next.t('general:registroDuplicado'));\n                      } else {\n                        d.rels_equipo_analisis[idx].eq_especs[ind].parametro = e;\n                        setInvalido(false);\n                      }\n                    } else {\n                      d.rels_equipo_analisis[idx].eq_especs[ind].parametro = {\n                        id: ''\n                      };\n                    }\n                  })),\n                  labelKey: \"nombre\",\n                  className: `mr-2 ${esp.parametro.id === '' ? 'is-invalid' : ''}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 144,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Campo, {\n                etiqueta: `${i18next.t('admin:valorInicioMinimo')}:`,\n                value: esp.inicio_minimo || '',\n                onChange: e => setEqEspecs(produce(eqEspecs, d => {\n                  d.rels_equipo_analisis[idx].eq_especs[ind].inicio_minimo = e.target.value;\n                })),\n                type: \"number\",\n                containerClass: \"d-flex justify-content-start mt-1\",\n                labelClass: \"text-nowrap mr-2\",\n                inputClass: \"form-control form-control-sm\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Campo, {\n                etiqueta: `${i18next.t('admin:valorInicioMaximo')}:`,\n                value: esp.inicio_maximo || '',\n                onChange: e => setEqEspecs(produce(eqEspecs, d => {\n                  d.rels_equipo_analisis[idx].eq_especs[ind].inicio_maximo = e.target.value;\n                })),\n                type: \"number\",\n                containerClass: \"d-flex justify-content-start mt-1\",\n                labelClass: \"text-nowrap mr-2\",\n                inputClass: \"form-control form-control-sm\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Campo, {\n                etiqueta: `${i18next.t('admin:valorFinMinimo')}:`,\n                value: esp.fin_minimo || '',\n                onChange: e => setEqEspecs(produce(eqEspecs, d => {\n                  d.rels_equipo_analisis[idx].eq_especs[ind].fin_minimo = e.target.value;\n                })),\n                type: \"number\",\n                containerClass: \"d-flex justify-content-start mt-1\",\n                labelClass: \"text-nowrap mr-2\",\n                inputClass: \"form-control form-control-sm\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Campo, {\n                etiqueta: `${i18next.t('admin:valorFinMaximo')}:`,\n                value: esp.fin_maximo || '',\n                onChange: e => setEqEspecs(produce(eqEspecs, d => {\n                  d.rels_equipo_analisis[idx].eq_especs[ind].fin_maximo = e.target.value;\n                })),\n                type: \"number\",\n                containerClass: \"d-flex justify-content-start mt-1\",\n                labelClass: \"text-nowrap mr-2\",\n                inputClass: \"form-control form-control-sm\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 41\n              }, this)]\n            }, ind, true, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 29\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Analisis, \"4hiTEM4C2WmYeMuZkLqrNGMDgDo=\");\n\n_c = Analisis;\nexport default Analisis;\n\nvar _c;\n\n$RefreshReg$(_c, \"Analisis\");","map":{"version":3,"sources":["/home/frangb/Documentos/xolos/practicas/src/components/Admin/EspecificacionEquipo/Analisis.js"],"names":["React","useEffect","useState","i18next","Boton","FaSave","Select","produce","Campo","FaPlusCircle","FaTrash","guardarEspecificaciones","cerrarAlert","ocultableInfo","noop","TooltipHover","can","Analisis","equipo","analisis","parametros","cargarRegistros","eqEspecs","setEqEspecs","invalido","setInvalido","agregarAnalisis","d","rels_equipo_analisis","push","eq_especs","equipo_id","id","eliminarAnalisis","idx","splice","agregarEspecificacion","inicio_minimo","inicio_maximo","fin_minimo","fin_maximo","parametro","eliminarEspecificacion","ind","guardar","console","log","then","res","catch","t","map","eqAna","e","resultado","find","eq","esp","target","value"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport i18next from \"i18next\";\nimport Boton from \"../../Template/Boton\";\nimport {FaSave} from \"react-icons/all\";\nimport Select from \"../../Template/Select\";\nimport produce from \"immer\";\nimport Campo from \"../../Template/Campo\";\nimport {FaPlusCircle, FaTrash} from \"react-icons/fa\";\nimport {guardarEspecificaciones} from \"../../../api/adminApi\";\nimport {cerrarAlert, ocultableInfo} from \"../../../services/swalService\";\nimport {noop} from \"../../../services/generalService\";\nimport TooltipHover from \"../../Template/TooltipHover\";\nimport {can} from '../../../services/seguridadService';\n\nconst Analisis = ({equipo, analisis, parametros, cargarRegistros}) => {\n    //|------hooks------|//\n    const [eqEspecs, setEqEspecs] = useState([]);\n    const [invalido, setInvalido] = useState(false);\n    //|------useEffect------|//\n    useEffect(() => {\n        setEqEspecs(equipo);\n    }, [equipo]);\n    //|------Operaciones------|//\n    const agregarAnalisis = () => {\n        setEqEspecs(produce(eqEspecs, d => {\n            d.rels_equipo_analisis.push({analisis: {}, eq_especs: [], equipo_id: equipo.id})\n        }))\n    }\n    const eliminarAnalisis = (idx) => {\n        setEqEspecs(produce(eqEspecs, d => {\n            d.rels_equipo_analisis.splice(idx, 1);\n        }))\n        setInvalido(false);\n    }\n    const agregarEspecificacion = (idx) => {\n        setEqEspecs(produce(eqEspecs, d => {\n            d.rels_equipo_analisis[idx].eq_especs.push({\n                inicio_minimo: '',\n                inicio_maximo: '',\n                fin_minimo: '',\n                fin_maximo: '',\n                parametro: {}\n            });\n        }))\n    }\n    const eliminarEspecificacion = (idx, ind) => {\n        setEqEspecs(produce(eqEspecs, d => {\n            d.rels_equipo_analisis[idx].eq_especs.splice(ind, 1);\n        }))\n        setInvalido(false);\n    }\n    //|-------Api-------|//\n    const guardar = () => {\n        console.log(eqEspecs.rels_equipo_analisis);\n        guardarEspecificaciones(eqEspecs).then(res => {\n            cerrarAlert();\n            cargarRegistros();\n        }).catch(noop());\n    }\n    return (\n        <div>\n            <div className=\"card d-flex mx-4 border-tabla z-depth-2 animated bounceInUp\">\n                <div className=\" card-header d-flex justify-content-between text-center py-2\">\n                    <div>\n                        <Boton key_texto={i18next.t('admin:agregarAnalisis')}\n                               className=\"btn btn-outline-success\"\n                               habilitado={can('admin.agregar_analisis')}\n                               ejecuta={() => agregarAnalisis()}>\n                            <FaPlusCircle/>\n                        </Boton>\n                    </div>\n                    <div>\n                        <Boton key_texto={i18next.t('general:guardar')}\n                               className=\"btn btn-outline-indigo\"\n                               habilitado={can('admin.guardar_especificacion')&&invalido===false}\n                               ejecuta={() => guardar()}>\n                            <FaSave/>\n                        </Boton>\n                    </div>\n                </div>\n                <div className=\"card-body\">\n                    {(eqEspecs.rels_equipo_analisis || []).map((eqAna, idx) =>\n                        <div key={idx}>\n                            <div className=\"d-flex justify-content-start mb-2\">\n                                <div className=\"d-flex justify-content-start\">\n                                    <span className=\"text-nowrap mr-2\">{i18next.t('admin:tipoAnalisis')}:</span>\n                                    <Select options={analisis}\n                                            selected={eqAna.analisis}\n                                            onSelect={e => setEqEspecs(produce(eqEspecs, d => {\n                                                let resultado = null;\n                                                if (e) {\n                                                    resultado = d.rels_equipo_analisis.find(eq => eq.analisis.id === e.id);\n                                                    if (resultado) {\n                                                        d.rels_equipo_analisis[idx].analisis = {id: ''};\n                                                        setInvalido(true);\n                                                        ocultableInfo(i18next.t('general:registroDuplicado'));\n                                                    } else {\n                                                        d.rels_equipo_analisis[idx].analisis = e;\n                                                        setInvalido(false);\n                                                    }\n                                                } else {\n                                                    d.rels_equipo_analisis[idx].analisis = {id: ''};\n                                                }\n                                            }))}\n                                            labelKey=\"nombre\"\n                                            className={`mr-2 ${eqAna.analisis.id === '' ? 'is-invalid' : ''}`}/>\n                                </div>\n                                <div>\n                                    {can('admin.agregar_especificacion') ?\n                                        <Boton key_texto={i18next.t('admin:agregarEspecificacion')}\n                                               className=\"btn btn-outline-success text-nowrap py-1 px-1 mb-1 mr-1\"\n                                               habilitado={true}\n                                               classNoHabilitado=\"w-70 p-0 m-0\"\n                                               ejecuta={() => agregarEspecificacion(idx)}>\n                                            <FaPlusCircle/>\n                                        </Boton> : null}\n                                    {can('admin.eliminar_analisis') ?\n                                        <Boton key_texto={i18next.t('admin:eliminarAnalisis')}\n                                               className=\"btn btn-outline-danger text-nowrap py-1 px-1 mb-1\"\n                                               classNoHabilitado=\"w-50 p-0 m-0\"\n                                               habilitado={true}\n                                               ejecuta={() => eliminarAnalisis(idx)}>\n                                            <FaTrash/>\n                                        </Boton> : null}\n                                </div>\n                            </div>\n                            <div className=\"d-flex justify-content-start flex-wrap\">\n                                {(eqAna.eq_especs || []).map((esp, ind) =>\n                                    <div key={ind} className=\"jumbotron mr-1 py-1 pt-1 px-2\">\n                                        {can('admin.eliminar_especificacion') ?\n                                            <div className=\"d-flex justify-content-end mb-1\">\n                                                <TooltipHover posicion=\"bottom\" texto={i18next.t('general:eliminar')}>\n                                                    <button type=\"button\" className=\"close\" data-dismiss=\"alert\"\n                                                            aria-label=\"Close\"\n                                                            onClick={() => eliminarEspecificacion(idx, ind)}>\n                                                        <span aria-hidden=\"true\">&times;</span>\n                                                    </button>\n                                                </TooltipHover>\n                                            </div> : null}\n                                        <div className=\"d-flex justify-content-start\">\n                                        <span className=\"text-nowrap mr-2\">\n                                            {i18next.t('admin:tipoParametro')}:\n                                        </span>\n                                            <Select options={parametros}\n                                                    selected={esp.parametro || {id: ''}}\n                                                    onSelect={e => setEqEspecs(produce(eqEspecs, d => {\n                                                        let resultado = null;\n                                                        if (e) {\n                                                            resultado = d.rels_equipo_analisis[idx].eq_especs.find(eq => eq.parametro.id === e.id);\n                                                            if (resultado) {\n                                                                d.rels_equipo_analisis[idx].eq_especs[ind].parametro = {id: ''};\n                                                                setInvalido(true);\n                                                                ocultableInfo(i18next.t('general:registroDuplicado'));\n                                                            } else {\n                                                                d.rels_equipo_analisis[idx].eq_especs[ind].parametro = e;\n                                                                setInvalido(false);\n                                                            }\n                                                        } else {\n                                                            d.rels_equipo_analisis[idx].eq_especs[ind].parametro = {id: ''};\n                                                        }\n                                                    }))}\n                                                    labelKey=\"nombre\"\n                                                    className={`mr-2 ${esp.parametro.id === '' ? 'is-invalid' : ''}`}/>\n                                        </div>\n                                        <Campo etiqueta={`${i18next.t('admin:valorInicioMinimo')}:`}\n                                               value={esp.inicio_minimo || ''}\n                                               onChange={e => setEqEspecs(produce(eqEspecs, d => {\n                                                   d.rels_equipo_analisis[idx].eq_especs[ind].inicio_minimo = e.target.value;\n                                               }))}\n                                               type=\"number\"\n                                               containerClass=\"d-flex justify-content-start mt-1\"\n                                               labelClass=\"text-nowrap mr-2\"\n                                               inputClass=\"form-control form-control-sm\"/>\n                                        <Campo etiqueta={`${i18next.t('admin:valorInicioMaximo')}:`}\n                                               value={esp.inicio_maximo || ''}\n                                               onChange={e => setEqEspecs(produce(eqEspecs, d => {\n                                                   d.rels_equipo_analisis[idx].eq_especs[ind].inicio_maximo = e.target.value;\n                                               }))}\n                                               type=\"number\"\n                                               containerClass=\"d-flex justify-content-start mt-1\"\n                                               labelClass=\"text-nowrap mr-2\"\n                                               inputClass=\"form-control form-control-sm\"/>\n                                        <Campo etiqueta={`${i18next.t('admin:valorFinMinimo')}:`}\n                                               value={esp.fin_minimo || ''}\n                                               onChange={e => setEqEspecs(produce(eqEspecs, d => {\n                                                   d.rels_equipo_analisis[idx].eq_especs[ind].fin_minimo = e.target.value;\n                                               }))}\n                                               type=\"number\"\n                                               containerClass=\"d-flex justify-content-start mt-1\"\n                                               labelClass=\"text-nowrap mr-2\"\n                                               inputClass=\"form-control form-control-sm\"/>\n                                        <Campo etiqueta={`${i18next.t('admin:valorFinMaximo')}:`}\n                                               value={esp.fin_maximo || ''}\n                                               onChange={e => setEqEspecs(produce(eqEspecs, d => {\n                                                   d.rels_equipo_analisis[idx].eq_especs[ind].fin_maximo = e.target.value;\n                                               }))}\n                                               type=\"number\"\n                                               containerClass=\"d-flex justify-content-start mt-1\"\n                                               labelClass=\"text-nowrap mr-2\"\n                                               inputClass=\"form-control form-control-sm\"/>\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default Analisis;"]},"metadata":{},"sourceType":"module"}